delete custom_report_types where id = 999990;
insert ignore into custom_report_types values (999990,"Alarm List","Alarms","Alarms/AlarmList.php"," Open:open:checkbox:OSS_NULLABLE.OSS_DIGIT:1;Close:close:checkbox:OSS_NULLABLE.OSS_DIGIT:1;Entities:ENTITIES:multiselect:OSS_HEX","select al.timestamp as altime, al.status as status, al.plugin_sid as plugin_sid, al.plugin_id as plugin_id, hex(al.event_id) as event_id, hex(al.corr_engine_ctx) as ctx, pp.name as alname, inet6_ntoa(al.src_ip) as srcip, srchost.hostname as srcname, inet6_ntoa(al.dst_ip) as dstip, dsthost.hostname as dstname, al.risk as alrisk, acat.name as catname, hex(otx.pulse_id) as pulse_id, atax.subcategory as catsub, ent.name as entname from alarm as al left join plugin_sid as pp on pp.plugin_id = al.plugin_id and pp.sid = al.plugin_sid left join host_ip as srcip on srcip.ip = al.src_ip left join host as srchost on srcip.host_id = srchost.id left join host_ip as dstip on dstip.ip = al.dst_ip left join host as dsthost on dstip.host_id = dsthost.id left join alarm_taxonomy as atax on atax.sid = al.plugin_sid and atax.engine_id = al.corr_engine_ctx left join alarm_categories as acat on acat.id = atax.category left join otx_data as otx on otx.event_id = al.event_id left join alarm_ctxs alctx on al.backlog_id = alctx.id_alarm and alctx.id_ctx <> al.corr_engine_ctx left join acl_entities ent on alctx.id_ctx = ent.id where",1);
